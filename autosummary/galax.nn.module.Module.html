<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>galax.nn.module.Module &mdash; galax  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="galax.nn.module.Sequential" href="galax.nn.module.Sequential.html" />
    <link rel="prev" title="galax.nn.module.ApplyNodes" href="galax.nn.module.ApplyNodes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> galax
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="galax.heterograph.html">galax.heterograph</a></li>
<li class="toctree-l2"><a class="reference internal" href="galax.function.html">galax.function</a></li>
<li class="toctree-l2"><a class="reference internal" href="galax.core.html">galax.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="galax.data.html">galax.data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="galax.nn.html">galax.nn</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="galax.nn.module.html">galax.nn.module</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="galax.nn.module.ApplyNodes.html">galax.nn.module.ApplyNodes</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">galax.nn.module.Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="galax.nn.module.Sequential.html">galax.nn.module.Sequential</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="galax.nn.utils.html">galax.nn.utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="galax.nn.zoo.html">galax.nn.zoo</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">galax</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">API Documentation</a> &raquo;</li>
          <li><a href="galax.nn.html">galax.nn</a> &raquo;</li>
          <li><a href="galax.nn.module.html">galax.nn.module</a> &raquo;</li>
      <li>galax.nn.module.Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/autosummary/galax.nn.module.Module.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="galax-nn-module-module">
<h1>galax.nn.module.Module<a class="headerlink" href="#galax-nn-module-module" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="galax.nn.module.Module">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">galax.nn.module.</span></span><span class="sig-name descname"><span class="pre">Module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">parent:</span> <span class="pre">Union[Type[flax.linen.module.Module],</span> <span class="pre">Type[flax.core.scope.Scope],</span> <span class="pre">Type[flax.linen.module._Sentinel],</span> <span class="pre">NoneType]</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f607edda950&gt;,</span> <span class="pre">name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galax/nn/module.html#Module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">flax.linen.module.Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">parent:</span> <span class="pre">Optional[Union[Type[flax.linen.module.Module],</span> <span class="pre">Type[flax.core.scope.Scope],</span> <span class="pre">Type[flax.linen.module._Sentinel]]]</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;,</span> <span class="pre">name:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#galax.nn.module.Module.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#galax.nn.module.Module.__init__" title="galax.nn.module.Module.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>([parent, name])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.apply" title="galax.nn.module.Module.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code></a>(variables, *args[, rngs, method, ...])</p></td>
<td><p>Applies a module method to variables and returns output and modified variables.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#galax.nn.module.Module.bind" title="galax.nn.module.Module.bind"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bind</span></code></a>(variables, *args[, rngs, mutable])</p></td>
<td><p>Creates an interactive Module instance by binding variables and RNGs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.clone" title="galax.nn.module.Module.clone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clone</span></code></a>(*[, parent])</p></td>
<td><p>Creates a clone of this Module, with optionally updated arguments.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#galax.nn.module.Module.get_variable" title="galax.nn.module.Module.get_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_variable</span></code></a>(col, name[, default])</p></td>
<td><p>Retrieves the value of a Variable.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.has_rng" title="galax.nn.module.Module.has_rng"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_rng</span></code></a>(name)</p></td>
<td><p>Returns true if a PRNGSequence with name <cite>name</cite> exists.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#galax.nn.module.Module.has_variable" title="galax.nn.module.Module.has_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_variable</span></code></a>(col, name)</p></td>
<td><p>Checks if a variable of given collection and name exists in this Module.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.init" title="galax.nn.module.Module.init"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init</span></code></a>(*args, **kwargs)</p></td>
<td><p>Initializes a module method with variables and returns modified variables.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#galax.nn.module.Module.init_with_output" title="galax.nn.module.Module.init_with_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_with_output</span></code></a>(rngs, *args[, method, mutable])</p></td>
<td><p>Initializes a module method with variables and returns output and modified variables.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.is_mutable_collection" title="galax.nn.module.Module.is_mutable_collection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_mutable_collection</span></code></a>(col)</p></td>
<td><p>Returns true if the collection <cite>col</cite> is mutable.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#galax.nn.module.Module.make_rng" title="galax.nn.module.Module.make_rng"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_rng</span></code></a>(name)</p></td>
<td><p>Returns a new RNG key from a given RNG sequence for this Module.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.param" title="galax.nn.module.Module.param"><code class="xref py py-obj docutils literal notranslate"><span class="pre">param</span></code></a>(name, init_fn, *init_args)</p></td>
<td><p>Declares and returns a parameter in this Module.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#galax.nn.module.Module.put_variable" title="galax.nn.module.Module.put_variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">put_variable</span></code></a>(col, name, value)</p></td>
<td><p>Sets the value of a Variable.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.setup" title="galax.nn.module.Module.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>()</p></td>
<td><p>Initializes a Module lazily (similar to a lazy <code class="docutils literal notranslate"><span class="pre">__init__</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#galax.nn.module.Module.sow" title="galax.nn.module.Module.sow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sow</span></code></a>()</p></td>
<td><p>Stores a value in a collection.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.tabulate" title="galax.nn.module.Module.tabulate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tabulate</span></code></a>(rngs, *args[, method, mutable, ...])</p></td>
<td><p>Creates a summary of the Module represented as a table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">uno</span></code>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.variable" title="galax.nn.module.Module.variable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">variable</span></code></a>(col, name[, init_fn])</p></td>
<td><p>Declares and returns a variable in this Module.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parent</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">scope</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#galax.nn.module.Module.variables" title="galax.nn.module.Module.variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables</span></code></a></p></td>
<td><p>Returns the variables in this module.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">flax.core.scope.DenyList</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capture_intermediates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">flax.linen.module.Module</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">flax.core.frozen_dict.FrozenDict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.apply" title="Permalink to this definition"></a></dt>
<dd><p>Applies a module method to variables and returns output and modified variables.</p>
<p>Note that <cite>method</cite> should be set if one would like to call <cite>apply</cite> on a
different class method than <code class="docutils literal notranslate"><span class="pre">__call__</span></code>. For instance, suppose a
Transformer modules has a method called <cite>encode</cite>, then the following calls
<cite>apply</cite> on that method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">()</span>
<span class="n">encoded</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">({</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">Transformer</span><span class="o">.</span><span class="n">encode</span><span class="p">)</span>
</pre></div>
</div>
<p>If a function instance is provided, the unbound function is used. For
instance, the example below is equivalent to the one above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">encoded</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">({</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">)</span>
</pre></div>
</div>
<p>Note <code class="docutils literal notranslate"><span class="pre">method</span></code> can also be a function that is not defined in
<code class="docutils literal notranslate"><span class="pre">Transformer</span></code>. In that case, the function should have at least one
argument representing an instance of the Module class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">other_fn</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
  <span class="n">instance</span><span class="o">.</span><span class="n">some_module_attr</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">...</span>

<span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">({</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">other_fn</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>variables: A dictionary containing variables keyed by variable</dt><dd><p>collections. See <code class="xref py py-mod docutils literal notranslate"><span class="pre">flax.core.variables</span></code> for more details
about variables.</p>
</dd>
</dl>
<p><a href="#id1"><span class="problematic" id="id2">*</span></a>args: Named arguments passed to the specified apply method.
rngs: a dict of PRNGKeys to initialize the PRNG sequences.</p>
<blockquote>
<div><p>The “params” PRNG sequence is used to initialize parameters.</p>
</div></blockquote>
<dl class="simple">
<dt>method: A function to call apply on. This is generally a function in the</dt><dd><p>module. If provided, applies this method. If not provided, applies the
<code class="docutils literal notranslate"><span class="pre">__call__</span></code> method of the module.</p>
</dd>
<dt>mutable: Can be bool, str, or list. Specifies which collections should be</dt><dd><p>treated as mutable: <code class="docutils literal notranslate"><span class="pre">bool</span></code>: all/no collections are mutable.
<code class="docutils literal notranslate"><span class="pre">str</span></code>: The name of a single mutable collection. <code class="docutils literal notranslate"><span class="pre">list</span></code>: A
list of names of mutable collections.</p>
</dd>
<dt>capture_intermediates: If <cite>True</cite>, captures intermediate return values</dt><dd><p>of all Modules inside the “intermediates” collection. By default only
the return values of all <code class="docutils literal notranslate"><span class="pre">__call__</span></code> methods are stored. A function can
be passed to change the filter behavior. The filter function takes
the Module instance and method name and returns a bool indicating
whether the output of that method invocation should be stored.</p>
</dd>
</dl>
<p><a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs: Keyword arguments passed to the specified apply method.</p>
</dd>
<dt>Returns:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">mutable</span></code> is False, returns output. If any collections are
mutable, returns <code class="docutils literal notranslate"><span class="pre">(output,</span> <span class="pre">vars)</span></code>, where <code class="docutils literal notranslate"><span class="pre">vars</span></code> are is a dict
of the modified collections.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.bind">
<span class="sig-name descname"><span class="pre">bind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">flax.core.scope.DenyList</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.bind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.bind" title="Permalink to this definition"></a></dt>
<dd><p>Creates an interactive Module instance by binding variables and RNGs.</p>
<p><code class="docutils literal notranslate"><span class="pre">bind</span></code> provides an “interactive” instance of a Module directly without
transforming a function with <code class="docutils literal notranslate"><span class="pre">apply</span></code>. This is particalary useful for debugging
and interactive use cases like notebooks where a function would limit the ability
split up code into different cells.</p>
<p>Once the variables (and optionally RNGs) are bound to a <code class="docutils literal notranslate"><span class="pre">Module</span></code> it becomes a
stateful object. Note that idiomatic JAX is functional and therefore an interactive
instance does not mix well well with vanilla JAX APIs. <code class="docutils literal notranslate"><span class="pre">bind()</span></code> should only be used
for interactive experimentation, and in all other cases we strongly encourage
to use <code class="docutils literal notranslate"><span class="pre">apply()</span></code> instead.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">flax.linen</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="k">class</span> <span class="nc">AutoEncoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">ae</span> <span class="o">=</span> <span class="n">AutoEncoder</span><span class="p">()</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">ae</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ae</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x_reconstructed</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>variables: A dictionary containing variables keyed by variable</dt><dd><p>collections. See <code class="xref py py-mod docutils literal notranslate"><span class="pre">flax.core.variables</span></code> for more details
about variables.</p>
</dd>
</dl>
<p><a href="#id5"><span class="problematic" id="id6">*</span></a>args: Named arguments (not used).
rngs: a dict of PRNGKeys to initialize the PRNG sequences.
mutable: Can be bool, str, or list. Specifies which collections should be</p>
<blockquote>
<div><dl class="simple">
<dt>treated as mutable:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">bool</span></code>: all/no collections are mutable.
<code class="docutils literal notranslate"><span class="pre">str</span></code>: The name of a single mutable collection.
<code class="docutils literal notranslate"><span class="pre">list</span></code>: A list of names of mutable collections.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>A copy of this instance with bound variables and RNGs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">flax.core.scope.Scope</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">flax.linen.module.Module</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">flax.linen.module.Module</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.clone" title="Permalink to this definition"></a></dt>
<dd><p>Creates a clone of this Module, with optionally updated arguments.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>parent: The parent of the clone. The clone will have no parent if no</dt><dd><p>explicit parent is specified.</p>
</dd>
</dl>
<p><a href="#id7"><span class="problematic" id="id8">**</span></a>updates: Attribute updates.</p>
</dd>
<dt>Returns:</dt><dd><p>A clone of the this Module with the updated attributes and parent.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.get_variable">
<span class="sig-name descname"><span class="pre">get_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">flax.linen.module.T</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">flax.linen.module.T</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.get_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.get_variable" title="Permalink to this definition"></a></dt>
<dd><p>Retrieves the value of a Variable.</p>
<dl>
<dt>Args:</dt><dd><p>col: the variable collection.
name: the name of the variable.
default: the default value to return if the variable does not exist in</p>
<blockquote>
<div><p>this scope.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>The value of the input variable, of the default value if the variable
doesn’t exist in this scope.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.has_rng">
<span class="sig-name descname"><span class="pre">has_rng</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.has_rng"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.has_rng" title="Permalink to this definition"></a></dt>
<dd><p>Returns true if a PRNGSequence with name <cite>name</cite> exists.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.has_variable">
<span class="sig-name descname"><span class="pre">has_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.has_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.has_variable" title="Permalink to this definition"></a></dt>
<dd><p>Checks if a variable of given collection and name exists in this Module.</p>
<p>See <code class="xref py py-mod docutils literal notranslate"><span class="pre">flax.core.variables</span></code> for more explanation on variables and
collections.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>col: The variable collection name.
name: The name of the variable.</p>
</dd>
<dt>Returns:</dt><dd><p>True if the variable exists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galax/nn/module.html#Module.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.init" title="Permalink to this definition"></a></dt>
<dd><p>Initializes a module method with variables and returns modified variables.</p>
<p>Jitting <cite>init</cite> initializes a model lazily using only the shapes of the
provided arguments, and avoids computing the forward pass with actual
values. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jit_init</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">SomeModule</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">)</span>
<span class="n">jit_init</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
</pre></div>
</div>
<dl>
<dt>Args:</dt><dd><p>rngs: The rngs for the variable collections.
<a href="#id9"><span class="problematic" id="id10">*</span></a>args: Named arguments passed to the init function.
method: An optional method. If provided, applies this method. If not</p>
<blockquote>
<div><p>provided, applies the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method.</p>
</div></blockquote>
<dl class="simple">
<dt>mutable: Can be bool, str, or list. Specifies which collections should be</dt><dd><p>treated as mutable: <code class="docutils literal notranslate"><span class="pre">bool</span></code>: all/no collections are mutable.
<code class="docutils literal notranslate"><span class="pre">str</span></code>: The name of a single mutable collection. <code class="docutils literal notranslate"><span class="pre">list</span></code>: A
list of names of mutable collections. By default all collections
except “intermediates” are mutable.</p>
</dd>
</dl>
<p><a href="#id11"><span class="problematic" id="id12">**</span></a>kwargs: Keyword arguments passed to the init function.</p>
</dd>
<dt>Returns:</dt><dd><p>The initialized variable dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.init_with_output">
<span class="sig-name descname"><span class="pre">init_with_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">flax.core.scope.DenyList</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">DenyList(deny='intermediates')</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">flax.core.frozen_dict.FrozenDict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.init_with_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.init_with_output" title="Permalink to this definition"></a></dt>
<dd><p>Initializes a module method with variables and returns output and modified variables.</p>
<dl>
<dt>Args:</dt><dd><p>rngs: The rngs for the variable collections.
<a href="#id13"><span class="problematic" id="id14">*</span></a>args: Named arguments passed to the init function.
method: An optional method. If provided, applies this method. If not</p>
<blockquote>
<div><p>provided, applies the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method.</p>
</div></blockquote>
<dl class="simple">
<dt>mutable: Can be bool, str, or list. Specifies which collections should be</dt><dd><p>treated as mutable: <code class="docutils literal notranslate"><span class="pre">bool</span></code>: all/no collections are mutable.
<code class="docutils literal notranslate"><span class="pre">str</span></code>: The name of a single mutable collection. <code class="docutils literal notranslate"><span class="pre">list</span></code>: A
list of names of mutable collections. By default all collections
except “intermediates” are mutable.</p>
</dd>
</dl>
<p><a href="#id15"><span class="problematic" id="id16">**</span></a>kwargs: Keyword arguments passed to the init function.</p>
</dd>
<dt>Returns:</dt><dd><p><cite>(output, vars)`</cite>, where <code class="docutils literal notranslate"><span class="pre">vars</span></code> are is a dict of the modified
collections.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.is_mutable_collection">
<span class="sig-name descname"><span class="pre">is_mutable_collection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.is_mutable_collection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.is_mutable_collection" title="Permalink to this definition"></a></dt>
<dd><p>Returns true if the collection <cite>col</cite> is mutable.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.make_rng">
<span class="sig-name descname"><span class="pre">make_rng</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.make_rng"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.make_rng" title="Permalink to this definition"></a></dt>
<dd><p>Returns a new RNG key from a given RNG sequence for this Module.</p>
<p>The new RNG key is split from the previous one. Thus, every call to
<cite>make_rng</cite> returns a new RNG key, while still guaranteeing full
reproducibility.</p>
<p>TODO: Link to Flax RNG design note.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name: The RNG sequence name.</p>
</dd>
<dt>Returns:</dt><dd><p>The newly generated RNG key.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.param">
<span class="sig-name descname"><span class="pre">param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">flax.linen.module.T</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">init_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">flax.linen.module.T</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.param" title="Permalink to this definition"></a></dt>
<dd><p>Declares and returns a parameter in this Module.</p>
<p>Parameters are read-only variables in the collection named “params”. See
<code class="xref py py-mod docutils literal notranslate"><span class="pre">flax.core.variables</span></code> for more details on variables.</p>
<p>The first argument of <cite>init_fn</cite> is assumed to be a PRNG key, which is
provided automatically and does not have to be passed using <cite>init_args</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">lecun_normal</span><span class="p">(),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>In the example above, the function <cite>lecun_normal</cite> expects two arguments:
<cite>key</cite> and <cite>shape</cite>, but only <cite>shape</cite> has to be provided explicitly; <cite>key</cite>
is set automatically using the PRNG for <cite>params</cite> that is passed when
initializing the module using <a class="reference internal" href="#galax.nn.module.Module.init" title="galax.nn.module.Module.init"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init()</span></code></a>.</p>
<dl>
<dt>Args:</dt><dd><p>name: The parameter name.
init_fn: The function that will be called to compute the initial value</p>
<blockquote>
<div><p>of this variable. This function will only be called the first time
this parameter is used in this module.</p>
</div></blockquote>
<p><a href="#id17"><span class="problematic" id="id18">*</span></a>init_args: The arguments to pass to init_fn.</p>
</dd>
<dt>Returns:</dt><dd><p>The value of the initialized parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.put_variable">
<span class="sig-name descname"><span class="pre">put_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.put_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.put_variable" title="Permalink to this definition"></a></dt>
<dd><p>Sets the value of a Variable.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>col: the variable collection.
name: the name of the variable.
value: the new value of the variable.</p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.setup" title="Permalink to this definition"></a></dt>
<dd><p>Initializes a Module lazily (similar to a lazy <code class="docutils literal notranslate"><span class="pre">__init__</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">setup</span></code> is called once lazily on a module instance when a module
is bound, immediately before any other methods like <code class="docutils literal notranslate"><span class="pre">__call__</span></code> are
invoked, or before a <code class="docutils literal notranslate"><span class="pre">setup</span></code>-defined attribute on <cite>self</cite> is accessed.</p>
<p>This can happen in three cases:</p>
<blockquote>
<div><ol class="arabic">
<li><p>Immediately when invoking <a class="reference internal" href="#galax.nn.module.Module.apply" title="galax.nn.module.Module.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a>, <a class="reference internal" href="#galax.nn.module.Module.init" title="galax.nn.module.Module.init"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init()</span></code></a> or
<code class="xref py py-meth docutils literal notranslate"><span class="pre">init_and_output()</span></code>.</p></li>
<li><p>Once the module is given a name by being assigned to an attribute of
another module inside the other module’s <code class="docutils literal notranslate"><span class="pre">setup</span></code> method
(see <code class="xref py py-meth docutils literal notranslate"><span class="pre">__setattr__()</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModule</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">submodule</span> <span class="o">=</span> <span class="n">Conv</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

    <span class="c1"># Accessing `submodule` attributes does not yet work here.</span>

    <span class="c1"># The following line invokes `self.__setattr__`, which gives</span>
    <span class="c1"># `submodule` the name &quot;conv1&quot;.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">submodule</span>

    <span class="c1"># Accessing `submodule` attributes or methods is now safe and</span>
    <span class="c1"># either causes setup() to be called once.</span>
</pre></div>
</div>
</li>
<li><p>Once a module is constructed inside a method wrapped with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">compact()</span></code>, immediately before another method is called or
<code class="docutils literal notranslate"><span class="pre">setup</span></code> defined attribute is accessed.</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.sow">
<span class="sig-name descname"><span class="pre">sow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">col:</span> <span class="pre">str,</span> <span class="pre">name:</span> <span class="pre">str,</span> <span class="pre">value:</span> <span class="pre">flax.linen.module.T,</span> <span class="pre">reduce_fn:</span> <span class="pre">Callable[[flax.linen.module.K,</span> <span class="pre">flax.linen.module.T],</span> <span class="pre">flax.linen.module.K]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;,</span> <span class="pre">init_fn:</span> <span class="pre">Callable[[],</span> <span class="pre">flax.linen.module.K]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.sow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.sow" title="Permalink to this definition"></a></dt>
<dd><p>Stores a value in a collection.</p>
<p>Collections can be used to collect intermediate values without
the overhead of explicitly passing a container through each Module call.</p>
<p>If the target collection is not mutable <cite>sow</cite> behaves like a no-op
and returns <cite>False</cite>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">flax.linen</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="nd">@nn</span><span class="o">.</span><span class="n">compact</span>
  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sow</span><span class="p">(</span><span class="s1">&#39;intermediates&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">h</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="n">y</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mutable</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;intermediates&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;intermediates&#39;</span><span class="p">])</span>  <span class="c1"># {&#39;h&#39;: (...,)}</span>
</pre></div>
</div>
<p>By default the values are stored in a tuple and each stored value
is appended at the end. This way all intermediates can be tracked when
the same module is called multiple times. Alternatively, a custom
init/reduce function can be passed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Foo2</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="nd">@nn</span><span class="o">.</span><span class="n">compact</span>
  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">init_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="mi">0</span>
    <span class="n">reduce_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sow</span><span class="p">(</span><span class="s1">&#39;intermediates&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
             <span class="n">init_fn</span><span class="o">=</span><span class="n">init_fn</span><span class="p">,</span> <span class="n">reduce_fn</span><span class="o">=</span><span class="n">reduce_fn</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sow</span><span class="p">(</span><span class="s1">&#39;intermediates&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
             <span class="n">init_fn</span><span class="o">=</span><span class="n">init_fn</span><span class="p">,</span> <span class="n">reduce_fn</span><span class="o">=</span><span class="n">reduce_fn</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Foo2</span><span class="p">()</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="n">y</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">mutable</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;intermediates&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;intermediates&#39;</span><span class="p">])</span>  <span class="c1"># ==&gt; {&#39;h&#39;: [[3.]]}</span>
</pre></div>
</div>
<dl>
<dt>Args:</dt><dd><p>col: The name of the variable collection.
name: The name of the variable.
value: The value of the variable.
reduce_fn: The function used to combine the existing value with</p>
<blockquote>
<div><p>the new value. The default is to append the value to a tuple.</p>
</div></blockquote>
<dl class="simple">
<dt>init_fn: For the first value stored, <cite>reduce_fn</cite> will be passed</dt><dd><p>the result of <cite>init_fn</cite> together with the value to be stored.
The default is an empty tuple.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><cite>True</cite> if the value has been stored successfully, <cite>False</cite> otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.tabulate">
<span class="sig-name descname"><span class="pre">tabulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rngs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">flax.core.scope.DenyList</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_methods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.tabulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.tabulate" title="Permalink to this definition"></a></dt>
<dd><p>Creates a summary of the Module represented as a table.</p>
<p>This method has the same signature as <cite>init</cite>, but instead of returning
the variables, it returns the string summarizing the Module in a table.
<cite>tabulate</cite> uses <cite>jax.eval_shape</cite> to run the forward computation without
consuming any FLOPs or allocating memory.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">flax.linen</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="nd">@nn</span><span class="o">.</span><span class="n">compact</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">h</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Foo</span><span class="p">()</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<p>This gives the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                   Foo Summary
┏━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┓
┃ path    ┃ outputs       ┃ params               ┃
┡━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━┩
│ Inputs  │ float32[16,9] │                      │
├─────────┼───────────────┼──────────────────────┤
│ Dense_0 │ float32[16,4] │ bias: float32[4]     │
│         │               │ kernel: float32[9,4] │
│         │               │                      │
│         │               │ 40 (160 B)           │
├─────────┼───────────────┼──────────────────────┤
│ Dense_1 │ float32[16,2] │ bias: float32[2]     │
│         │               │ kernel: float32[4,2] │
│         │               │                      │
│         │               │ 10 (40 B)            │
├─────────┼───────────────┼──────────────────────┤
│ Foo     │ float32[16,2] │                      │
├─────────┼───────────────┼──────────────────────┤
│         │         Total │ 50 (200 B)           │
└─────────┴───────────────┴──────────────────────┘

          Total Parameters: 50 (200 B)
</pre></div>
</div>
<p><strong>Note</strong>: rows order in the table does not represent execution order,
instead it aligns with the order of keys in <cite>variables</cite> which are sorted
alphabetically.</p>
<dl>
<dt>Args:</dt><dd><p>rngs: The rngs for the variable collections.
<a href="#id19"><span class="problematic" id="id20">*</span></a>args: The arguments to the forward computation.
method: An optional method. If provided, applies this method. If not</p>
<blockquote>
<div><p>provided, applies the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method.</p>
</div></blockquote>
<dl class="simple">
<dt>mutable: Can be bool, str, or list. Specifies which collections should be</dt><dd><p>treated as mutable: <code class="docutils literal notranslate"><span class="pre">bool</span></code>: all/no collections are mutable.
<code class="docutils literal notranslate"><span class="pre">str</span></code>: The name of a single mutable collection. <code class="docutils literal notranslate"><span class="pre">list</span></code>: A
list of names of mutable collections. By default all collections
except ‘intermediates’ are mutable.</p>
</dd>
<dt>depth: controls how many submodule deep the summary can go. By default its</dt><dd><p><cite>None</cite> which means no limit. If a submodule is not shown because of the
depth limit, its parameter count and bytes will be added to the row of
its first shown ancestor such that the sum of all rows always adds up to
the total number of parameters of the Module.</p>
</dd>
<dt>exclude_methods: A sequence of strings that specifies which methods should</dt><dd><p>be ignored. In case a module calls a helper method from its main method,
use this argument to exclude the helper method from the summary to avoid
ambiguity.</p>
</dd>
</dl>
<p><a href="#id21"><span class="problematic" id="id22">**</span></a>kwargs: keyword arguments to pass to the forward computation.</p>
</dd>
<dt>Returns:</dt><dd><p>A string summarizing the Module.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="galax.nn.module.Module.variable">
<span class="sig-name descname"><span class="pre">variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">init_args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">flax.core.scope.Variable</span></span></span><a class="reference internal" href="../_modules/flax/linen/module.html#Module.variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galax.nn.module.Module.variable" title="Permalink to this definition"></a></dt>
<dd><p>Declares and returns a variable in this Module.</p>
<p>See <code class="xref py py-mod docutils literal notranslate"><span class="pre">flax.core.variables</span></code> for more information. See also <a class="reference internal" href="#galax.nn.module.Module.param" title="galax.nn.module.Module.param"><code class="xref py py-meth docutils literal notranslate"><span class="pre">param()</span></code></a>
for a shorthand way to define read-only variables in the “params”
collection.</p>
<p>Contrary to <a class="reference internal" href="#galax.nn.module.Module.param" title="galax.nn.module.Module.param"><code class="xref py py-meth docutils literal notranslate"><span class="pre">param()</span></code></a>, all arguments passing using <cite>init_fn</cite> should be
passed on explicitly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_rng</span><span class="p">(</span><span class="s1">&#39;stats&#39;</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="s1">&#39;stats&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">lecun_normal</span><span class="p">(),</span> <span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>In the example above, the function <cite>lecun_normal</cite> expects two arguments:
<cite>key</cite> and <cite>shape</cite>, and both have to be passed on. The PRNG for <cite>stats</cite> has
to be provided explicitly when calling <a class="reference internal" href="#galax.nn.module.Module.init" title="galax.nn.module.Module.init"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init()</span></code></a> and <a class="reference internal" href="#galax.nn.module.Module.apply" title="galax.nn.module.Module.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a>.</p>
<dl>
<dt>Args:</dt><dd><p>col: The variable collection name.
name: The variable name.
init_fn: The function that will be called to compute the initial value</p>
<blockquote>
<div><p>of this variable. This function will only be called the first time
this variable is used in this module. If None, the variable must
already be initialized otherwise an error is raised.</p>
</div></blockquote>
<p><a href="#id23"><span class="problematic" id="id24">*</span></a>init_args: The arguments to pass to init_fn.</p>
</dd>
<dt>Returns:</dt><dd><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">flax.core.variables.Variable</span></code> that can be read or set via
“.value” attribute. Throws an error if the variable exists already.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="galax.nn.module.Module.variables">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#galax.nn.module.Module.variables" title="Permalink to this definition"></a></dt>
<dd><p>Returns the variables in this module.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="galax.nn.module.ApplyNodes.html" class="btn btn-neutral float-left" title="galax.nn.module.ApplyNodes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="galax.nn.module.Sequential.html" class="btn btn-neutral float-right" title="galax.nn.module.Sequential" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Yuanqing Wang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>